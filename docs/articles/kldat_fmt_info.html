<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Format Information For Carcass Data â€¢ qfmtchk</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Format Information For Carcass Data">
<meta property="og:description" content="qfmtchk">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qfmtchk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/extract_fmt_info.html">Extract Format Information From Export Program</a>
    </li>
    <li>
      <a href="../articles/kldat_fmt_info.html">Format Information For Carcass Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbzwsqualitasag/qfmtchk/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="kldat_fmt_info_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Format Information For Carcass Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fbzwsqualitasag/qfmtchk/blob/master/vignettes/kldat_fmt_info.Rmd"><code>vignettes/kldat_fmt_info.Rmd</code></a></small>
      <div class="hidden name"><code>kldat_fmt_info.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">qfmtchk</span>)</pre></body></html></div>
<div id="disclaimer" class="section level1">
<h1 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h1>
<p>This vignette shows how to extract data formats from the import routine of the carcass data (KLDAT) obtained from the Identitas database (TVD).</p>
</div>
<div id="reading-sql-program" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-sql-program" class="anchor"></a>Reading SQL Program</h1>
<p>In a first step, the SQL statements from the import routine are read. This is done internally in the extraction function. For reasons of checking, the import routine is read with the following statement</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">s_sql_prg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dsch_imp_3_pgb.sql"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"qfmtchk"</span>)
<span class="no">s_sql_routine</span> <span class="kw">&lt;-</span> <span class="st">"ImportSchlachtdatenTvd"</span>
<span class="no">s_exp_pattern</span> <span class="kw">&lt;-</span> <span class="st">"rowSTV.STV"</span>
<span class="no">vec_prg</span> <span class="kw">&lt;-</span> <span class="kw pkg">qfmtchk</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/read_sql_prg.html">read_sql_prg</a></span>(<span class="kw">ps_sql_prg_path</span>    <span class="kw">=</span> <span class="no">s_sql_prg</span>,
                                  <span class="kw">ps_sql_exp_routine</span> <span class="kw">=</span> <span class="no">s_sql_routine</span>,
                                  <span class="kw">ps_exp_pattern</span>     <span class="kw">=</span> <span class="no">s_exp_pattern</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">vec_prg</span>)
<span class="co">#&gt; [1] "         rowSTV.STV_STATUS         := 0;"                        </span>
<span class="co">#&gt; [2] "         rowSTV.STV_BTRAKTSTAO     := TRIM(SUBSTR(sLine,6,10));" </span>
<span class="co">#&gt; [3] "         rowSTV.STV_BTRTVD         := TRIM(SUBSTR(sLine,16,7));" </span>
<span class="co">#&gt; [4] "         rowSTV.STV_MUTTERID       := TRIM(SUBSTR(sLine,23,14));"</span>
<span class="co">#&gt; [5] "         rowSTV.STV_MUTTERRC       := TRIM(SUBSTR(sLine,37,3));" </span>
<span class="co">#&gt; [6] "         rowSTV.STV_TIERNAME       := TRIM(SUBSTR(sLine,40,12));"</span></pre></body></html></div>
</div>
<div id="format-extraction" class="section level1">
<h1 class="hasAnchor">
<a href="#format-extraction" class="anchor"></a>Format Extraction</h1>
<p>The format information can be extracted into a tibble with</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">tbl_kldat_fmt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/extract_kldat_fmt.html">extract_kldat_fmt</a></span>(<span class="kw">ps_sql_prg_path</span> <span class="kw">=</span> <span class="no">s_sql_prg</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">tbl_kldat_fmt</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">ColName</th>
<th align="right">StartPos</th>
<th align="right">EndPos</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">STV_BTRAKTSTAO</td>
<td align="right">6</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">STV_BTRTVD</td>
<td align="right">16</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">STV_MUTTERID</td>
<td align="right">23</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left">STV_MUTTERRC</td>
<td align="right">37</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="left">STV_TIERNAME</td>
<td align="right">40</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="left">STV_BTRABKALBUNG</td>
<td align="right">52</td>
<td align="right">61</td>
</tr>
<tr class="odd">
<td align="left">STV_BTRABKTVD</td>
<td align="right">62</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">STV_LAKTNR</td>
<td align="right">69</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">STV_GEBDAT</td>
<td align="right">71</td>
<td align="right">78</td>
</tr>
<tr class="even">
<td align="left">STV_TIERID</td>
<td align="right">79</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">STV_TIERRC</td>
<td align="right">93</td>
<td align="right">95</td>
</tr>
<tr class="even">
<td align="left">STV_SEX</td>
<td align="right">96</td>
<td align="right">96</td>
</tr>
<tr class="odd">
<td align="left">STV_MCODE</td>
<td align="right">97</td>
<td align="right">97</td>
</tr>
<tr class="even">
<td align="left">STV_VATERID</td>
<td align="right">98</td>
<td align="right">111</td>
</tr>
<tr class="odd">
<td align="left">STV_VATERRC</td>
<td align="right">112</td>
<td align="right">114</td>
</tr>
<tr class="even">
<td align="left">STV_ABORT</td>
<td align="right">115</td>
<td align="right">115</td>
</tr>
<tr class="odd">
<td align="left">STV_ZKZ</td>
<td align="right">116</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">STV_GEBVERL</td>
<td align="right">119</td>
<td align="right">119</td>
</tr>
<tr class="odd">
<td align="left">STV_VERENDET</td>
<td align="right">120</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="left">STV_GEBGEW</td>
<td align="right">121</td>
<td align="right">122</td>
</tr>
<tr class="odd">
<td align="left">STV_FARBE</td>
<td align="right">123</td>
<td align="right">124</td>
</tr>
<tr class="even">
<td align="left">STV_AUSWEIS</td>
<td align="right">125</td>
<td align="right">125</td>
</tr>
<tr class="odd">
<td align="left">STV_IDGENMUTTER</td>
<td align="right">126</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="left">STV_RCGENMUTTER</td>
<td align="right">140</td>
<td align="right">142</td>
</tr>
<tr class="odd">
<td align="left">STV_BESDAT</td>
<td align="right">143</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="left">STV_KASTRIER</td>
<td align="right">151</td>
<td align="right">151</td>
</tr>
<tr class="odd">
<td align="left">STV_SCHLACHTBTR</td>
<td align="right">152</td>
<td align="right">159</td>
</tr>
<tr class="even">
<td align="left">STV_SCHLACHTDAT</td>
<td align="right">160</td>
<td align="right">167</td>
</tr>
<tr class="odd">
<td align="left">STV_SCHLACHTGEW</td>
<td align="right">168</td>
<td align="right">171</td>
</tr>
<tr class="even">
<td align="left">STV_KLASSIERER</td>
<td align="right">172</td>
<td align="right">177</td>
</tr>
<tr class="odd">
<td align="left">STV_SCHLACHTKAT</td>
<td align="right">178</td>
<td align="right">179</td>
</tr>
<tr class="even">
<td align="left">STV_FLEISCHIGKEIT</td>
<td align="right">180</td>
<td align="right">181</td>
</tr>
<tr class="odd">
<td align="left">STV_FETTKLASSE</td>
<td align="right">182</td>
<td align="right">182</td>
</tr>
</tbody>
</table>
</div>
<div id="output" class="section level1">
<h1 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h1>
<p>As it seams with the above extracted format information, improvements are not required. Hence, we can directly write the fmt information to a file.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">s_kldat_fmt_file</span> <span class="kw">&lt;-</span> <span class="st">"kldat_check.fmt"</span>
<span class="fu"><a href="../reference/output_fmt.html">output_fmt</a></span>(<span class="kw">ps_fmt_outfile</span> <span class="kw">=</span> <span class="no">s_kldat_fmt_file</span>, <span class="kw">ptbl_fmt</span> <span class="kw">=</span> <span class="no">tbl_kldat_fmt</span>)</pre></body></html></div>
<p>The following chunk is checking the content of the created file</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(<span class="no">s_kldat_fmt_file</span>), <span class="kw">n</span><span class="kw">=</span><span class="fl">10L</span>), <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"\n"</span>)
<span class="co">#&gt; # STV_BTRAKTSTAO</span>
<span class="co">#&gt; [6-15]</span>
<span class="co">#&gt; data_required=True </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # STV_BTRTVD</span>
<span class="co">#&gt; [16-22]</span>
<span class="co">#&gt; data_required=True </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # STV_MUTTERID</span>
<span class="co">#&gt; [23-36]</span></pre></body></html></div>
<hr>
<p><em>Latest Changes: 2021-06-16 08:41:33 (pvr)</em></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Peter von Rohr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
